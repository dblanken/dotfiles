#!/usr/local/bin/bash
set -x
# Traverses each line and either
# comments or uncomments
toggle() {
  local cmt=^"${1:-#}".+$
  local prog

  while IFS= read -r line; do
    if [[ -z $prog ]]; then
      if [[ "${line}" =~ $cmt ]]; then
        prog='ucmt'
      else
        prog='cmt'
      fi
    fi

    echo "$line" | "$prog" "$1"
  done
}

toggle "$@"
